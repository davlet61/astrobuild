---
import { buttonVariants } from '../ui/button';

const linkClasses = buttonVariants({ variant: 'link' });
---

<script type="module" define:vars={{ linkClasses }}>
  import 'https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@3.0.1/dist/cookieconsent.umd.js';

  CookieConsent.run({
    guiOptions: {
      consentModal: {
        layout: 'box',
        position: 'bottom right',
        flipButtons: false,
        equalWeightButtons: true,
      },
      preferencesModal: {
        layout: 'box',
        position: 'left right',
        flipButtons: false,
        equalWeightButtons: true,
      },
    },
    categories: {
      necessary: {
        enabled: true,
        readOnly: true,
      },
      analytics: {
        autoClear: {
          cookies: [{ name: /^(_ga|_gid)/ }],
        },

        // https://cookieconsent.orestbida.com/reference/configuration-reference.html#category-services
        services: {
          ga: {
            label: 'Google Analytics',
            onAccept: () => {
              (function (w, d, s, l, i) {
                w[l] = w[l] || [];
                w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });
                var f = d.getElementsByTagName(s)[0],
                  j = d.createElement(s),
                  dl = l != 'dataLayer' ? '&l=' + l : '';
                j.async = true;
                j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
                f.parentNode.insertBefore(j, f);
              })(window, document, 'script', 'dataLayer', 'GTM-MXPGLQ5');
            },
            onReject: () => {
              document.cookie = '_ga=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
              document.cookie = '_gid=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
              document.cookie = '_gat=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';

              // Remove Google Tag Manager cookies
              document.cookie = '_dc_gtm_<property-id>=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';

              // Disable Google Analytics if it was loaded
              if (window.ga) {
                window.ga('remove');
              }

              var gtmScript = document.querySelector('script[src^="https://www.googletagmanager.com/gtm.js"]');
              if (gtmScript) {
                gtmScript.parentNode.removeChild(gtmScript);
              }

              console.log('Analytics services rejected');
            },
            cookies: [{ name: /^(_ga|_gid|_gat|_dc_gtm_)/ }],
          },
        },
      },
      ads: {},
    },
    language: {
      default: 'no',
      translations: {
        no: {
          consentModal: {
            title: 'Vi bruker informasjonskapsler!',
            description:
              'Hei, dette nettstedet bruker n칮dvendige informasjonskapsler for 친 sikre riktig drift og sporing av informasjonskapsler for 친 forst친 hvordan du samhandler med det. Sistnevnte vil kun bli satt etter samtykke. <button type="button" data-cc="c-settings" class="cc-link">Instillinger</button>',
            acceptAllBtn: 'Godta alle',
            acceptNecessaryBtn: 'Avvis alle',
            showPreferencesBtn: 'Innstillinger for informasjonskapsler',
            footer: `<a href="/personvern" class={${linkClasses}} target="_blank">Personvern</a>`,
          },
          preferencesModal: {
            title: 'Innstillinger for informasjonskapsler',
            savePreferencesBtn: 'Lagre innstillinger',
            acceptAllBtn: 'Godta alle',
            acceptNecessaryBtn: 'Avvis alle',
            closeIconLabel: 'Lukk',
            sections: [
              {
                title: 'Bruk av informasjonskapsler 游닉',
                description: `Vi bruker informasjonskapsler for 친 sikre de grunnleggende funksjonene p친 nettstedet og forbedre din online opplevelse. Du kan velge for hver kategori om du vil delta eller ikke n친r som helst. For flere detaljer relatert til informasjonskapsler og annen sensitiv data, vennligst les fullstendig <a href="/personvern" class={${linkClasses}}>Personvern</a>.`,
              },
              {
                title: 'Strengt n칮dvendige informasjonskapsler',
                description:
                  'Disse informasjonskapslene er essensielle for riktig funksjon av mitt nettsted. Uten disse informasjonskapslene ville nettstedet ikke fungere ordentlig',
                linkedCategory: 'necessary',
              },
              {
                title: 'Ytelse og analyse-informasjonskapsler',
                description: 'Disse informasjonskapslene lar nettstedet huske valgene du har gjort tidligere',
                linkedCategory: 'analytics',
                cookieTable: {
                  caption: 'Informasjonskapsler',
                  headers: {
                    name: 'Navn',
                    domain: 'Domene',
                    desc: 'Beskrivelse',
                  },
                  body: [
                    {
                      name: '_ga',
                      domain: location.hostname,
                      desc: 'Google Analytics: Brukes til 친 skille brukere.',
                    },
                    {
                      name: '_gid',
                      domain: location.hostname,
                      desc: 'Google Analytics: Brukes til 친 skille brukere.',
                    },
                    {
                      name: '_gat',
                      domain: location.hostname,
                      desc: 'Google Analytics: Brukes til 친 begrense antall foresp칮rsler.',
                    },
                    {
                      name: '_dc_gtm_<property-id>',
                      domain: location.hostname,
                      desc: 'Google Tag Manager: Brukes til 친 begrense antall foresp칮rsler.',
                    },
                  ],
                },
              },
              // {
              //   title: 'Annonsering og m친lrettede informasjonskapsler',
              //   description:
              //     'Disse informasjonskapslene samler inn informasjon om hvordan du bruker nettstedet, hvilke sider du har bes칮kt, og hvilke linker du har klikket p친. Alle dataene er anonymisert og kan ikke brukes til 친 identifisere deg',
              //   linkedCategory: 'ads',
              // },
              {
                title: 'Mer informasjon',
                description:
                  'For sp칮rsm친l ang친ende v친r informasjonskapselpolicy og dine valg, vennligst <a class="cc-link" href="/kontakt">kontakt oss</a>.',
              },
            ],
          },
        },
      },
    },
  });
</script>
<!-- <style>
  #cc-main {
    .cm__btn {
      @apply inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 bg-primary shadow hover:bg-primary/90 h-9 px-4 py-2 border-none;
      color: white !important;
    }
    .cm__btn--secondary {
      @apply inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 bg-secondary shadow-sm hover:bg-secondary/80 h-9 px-4 py-2 border-none;
      color: white !important;
    }
    .cm__btn[data-role='necessary'] {
      @apply inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 bg-destructive shadow-sm hover:bg-destructive/90 h-9 px-4 py-2 border-none;
      color: white !important;
    }
  }
</style> -->
